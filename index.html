<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/index.css">
</head>
<body>
    <div class="page">
        <div class="title">
            <img src="./images/05-baioti.png" alt="">
        </div>
        <div class="jiangpin">
            <div class="jp_title">我是奖品名称</div> 
            <div class="jp_box">
                <img src="./images/03-touxiang.png" alt="">
            </div>
            <ul class="toux_list">
                <!-- <div class="toux_lis">
                    <div class="toux_img"><img src="./images/03-touxiang.png" alt=""></div>
                    <div class="toux_name">微信头像</div>
                </div> -->
            </ul>
            <div class="cj_btn">开始抽奖</div>
            <div class="stop_btn">停止</div>
            
        </div>
        <div class="foot">
            <div class="foot_bg"></div>
            <div class="tab">
                <div class="tab1">
                    <img src="./images/05-liuyanshangqiang.png" alt="" class="tab_img">
                    <div class="tab_msg">留言上墙</div>
                </div> 
                <div class="tab2">
                    <img src="./images/05-lchoujiang.png" alt="" class="tab_img">
                    <div class="tab_msg active">现场抽奖</div>
                </div> 
                <div class="tab3">
                    <img src="./images/01-erweima.png" alt="" class="tab_img">
                    <div class="tab_msg">二维码</div>
                </div> 
                <div class="quanping" onclick="kaishi()">
                    <img src="./images/01-quanping.png" alt="">
                </div>
            </div>
        </div>
        <!-- <p class="Title">中奖名单显示</p>
        <ul class="prizeList">
     
        </ul>
        <div class="submit" data-id="0">开 始</div>
        <div class="stop" data-id="0">停止</div> -->
    </div>
    <script src="./js/jquery-3.3.1.min.js"></script>
    <script src="./js/quanping.js"></script>
    <script src="./js/index.js"></script>
    <script type="text/javascript">
    //从一个给定的数组arr中,随机返回num个不重复项
            function getArrayItems(arr, num) {
                //新建一个数组,将传入的数组复制过来,用于运算,而不要直接操作传入的数组;
                var temp_array = new Array();
                for (var index in arr) {
                    temp_array.push(arr[index]);
                }
                //取出的数值项,保存在此数组
                var return_array = new Array();
                for (var i = 0; i<num; i++) {
                    //判断如果数组还有可以取出的元素,以防下标越界
                    if (temp_array.length>0) {

                        //在数组中产生一个随机索引
                        var arrIndex = Math.floor(Math.random()*temp_array.length);
                        //将此随机索引的对应的数组元素值复制出来
                        return_array[i] = temp_array[arrIndex];
                        //然后删掉此索引的数组元素,这时候temp_array变为新的数组
                        temp_array.splice(arrIndex, 1);
                    } else {
                        //数组中数据项取完后,退出循环,比如数组本来只有10项,但要求取出20项.
                        break;
                    }
                };
                return return_array;
            }
        var interval;
        var res;
        $(".cj_btn").click(function(){
            clearInterval(interval);
            $(".jp_box").css('display','none');  
            $(".cj_btn").css('display','none');
            $(".stop_btn").css('display','block');
            $(".toux_list").css('display','block');
                $.get("data.json",{},function(data){
                    if(data){
                            function times(){
                                var ArrList = data;
                                 res = getArrayItems(ArrList,3);
                                str='';
                                for(o in res){
                                    num = parseInt(o)+1;
                                    str+='<div class="toux_lis">'+
                    '<div class="toux_img"><img src="'+res[o].url+'" alt=""></div>'+
                    '<div class="toux_name">'+res[o].name+'</div></div>';
                                }
                                $(".toux_list").html(str);
                                return res;
                            };
                            interval = setInterval(times,100);      
                    }else{  
                        alert('Ajax error!');
                    }
                },'json');
        })
        $('.stop_btn').click(function(){
            $(".stop_btn").css('display','none');
            $(".cj_btn").css('display','block');
            console.log(res);
            clearInterval(interval);
        });

        // tab
        var onOff = true;
        $('.tab1').click(function () {
                window.location.href = './page.html';
          });
          var onOff3 = true;
          $('.tab3').click(function () {
            if(onOff3) {
                $('.tab3 .tab_msg').addClass('active');
                $('.tab3 .tab_img').attr('src','./images/01-liuyanshangqiang.png');
            } else {
                $('.tab3 .tab_msg').removeClass('active');
                $('.tab3 .tab_img').attr('src','./images/05-liuyanshangqiang.png');
            }
            onOff3 = !onOff3;
          });
    </script>
</body>
</html>